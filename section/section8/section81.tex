\section{一阶微分方程}

一阶微分方程是指只涉及一个未知函数及其导数的微分方程. 通常形式为：$\displaystyle\dv{y}{x}=f(x,y)$, 其中 $y$ 是未知函数, $x$ 是自变量,
$f(x,y)$ 是关于 $x$ 和 $y$ 的函数.
解一阶微分方程通常需要使用微积分知识和积分技巧. 常见的一阶微分方程包括变量分离微分方程、可分离变量微分方程、齐次微分方程等.

\subsection{变量分离方程}

\begin{definition}[变量分离方程]
    形如 $\dfrac{\dd y}{\dd x}=f(x)g(x)$ 的方程称为\textit{变量分离微分方程}.
\end{definition}
\begin{example}
    (把原方程化为分离变量方程) 求下列微分方程的通解
    \setcounter{magicrownumbers}{0}
    \begin{table}[H]
        \centering
        \begin{tabular}{l | l | l}
            (\rownumber)$\displaystyle\tan x\cdot\frac{\dd y}{\dd x}-y=5.$         & (\rownumber)$x^2y'+y+1.$                          & (\rownumber)$y\dd x+(x^2-4x)\dd y=0.$ \\
            (\rownumber)$3\mathrm{e}^x\tan y\dd x+(1-\mathrm{e}^x)\sec^2y\dd y=0.$ & (\rownumber)$\dfrac{\dd y}{\dd x}=(1-y^2)\tan x.$ & (\rownumber)$y'\tan x=y\ln y.$        \\
        \end{tabular}
    \end{table}
\end{example}
\begin{solution}
    \begin{enumerate}[label=(\arabic{*})]
        \item 原方程化为 $\displaystyle\frac{\dd y}{y+5}=\frac{\dd x}{\tan x}$, 两边积分得
              $\ln|y+5|=\ln\sin x+\ln C$, 即 $y=C\sin x-5$.
        \item 原方程化为 $\displaystyle\frac{\dd y}{y+1}=\frac{\dd x}{x^2}$, 两边积分得
              $\ln|y+1|=C-\frac{1}{x}$, 即 $y=C\mathrm{e}^{-\frac{1}{x}}-1.$
        \item 原方程化为 $\displaystyle\frac{\dd y}{y}=\frac{\dd x}{4x-x^2}$, 两边积分得
              $\displaystyle\ln|y|=\frac{1}{4}\ln\left|\frac{x}{4-x}\right|+\ln C$, 即 $\displaystyle y=\sqrt[4]{\frac{Cx}{4-x}}.$
        \item 原方程化为 $\dfrac{3\mathrm{e}^x}{\mathrm{e}^x-1}\dd x=\dfrac{\dd y}{\sin y\cos y}$, 两边积分得
              $3\ln|\mathrm{e}^x-1|=\ln C|\tan y|$, 即 $(\mathrm{e}^x-1)^3=C\tan y$.
        \item 原方程化为 $\dfrac{\dd y}{1-y^2}=\tan x\dd x$, 两边积分得
              $\dfrac{1}{2}\ln\left|\dfrac{1+y}{1-y}\right|=-\ln C|\cos x|$, 即 $\sqrt{\dfrac{1+y}{1-y}}=C\sec x$.
        \item 原方程化为 $\dfrac{\dd y}{y\ln y}\cot x\dd x$, 两边积分得
              $\ln|\ln y|=\ln C|\sin x|$, 即 $y=C\mathrm{e}^{\sin x}$.
    \end{enumerate}
\end{solution}
\begin{example}
    求微分方程 $\displaystyle \cos y\dd x+\left(1+\mathrm{e}^{-x}\right)\sin y\dd y=0$ 满足 $\displaystyle y(0)=\frac{\pi}{4}$ 的特解.
\end{example}
\begin{solution}
    原式化为 $\displaystyle\frac{\dd x}{1+\mathrm{e}^{-x}}=-\tan y\dd y$, 两边积分, 得 $\displaystyle\ln|\cos y|=\ln\left(1+\mathrm{e}^x\right)+\ln C$,
    即 $\displaystyle\cos y=C\left(1+\mathrm{e}^x\right)$, 又 $\displaystyle y(0)=\frac{\pi}{4}$, 故 $\displaystyle C=\frac{\sqrt{2}}{4}$, 所以该微分方程的特解为 $\displaystyle y=\arccos \frac{\sqrt{2}}{4}\left(1+\mathrm{e}^x\right).$
\end{solution}

\begin{example}
    设 $F(x)$ 是 $f(x)$ 的一个原函数, 且 $\dfrac{f(x)}{F(x)}=-2,~F(0)=1$, 求 $\displaystyle\int_{0}^{+\infty}F(x)\dd x.$
\end{example}
\begin{solution}
    因为 $F(x)$ 是 $f(x)$ 的一个原函数, 所以 $F'(x)=f(x)$, 且 $f(x)=-2F(x)$, 则
    $$F'(x)=-F(x)\Rightarrow\dfrac{\dd F(x)}{F(x)}=-2\dd x$$
    两边积分得 $F(x)=C\mathrm{e}^{-2x}$, 又 $F(0)=1$, 所以 $C=1$, 于是
    \begin{flalign*}
        \int_{0}^{+\infty}\mathrm{e}^{-2x}\dd x=-\dfrac{1}{2}\mathrm{e}^{-2x}\biggl |_0^{+\infty}=\dfrac{1}{2}.
    \end{flalign*}
\end{solution}

\begin{example}
    设函数 $y=f(x)$ 在 $(0,+\infty)$ 内严格单调递增且可导, $x=f^{-1}(y)$ 为其反函数,
    $$\forall x,y>0,xy\leqslant \dfrac{1}{2}\qty[xf(x)+yf^{-1}(y)]$$ 求 $f(x)$ 的解析式.
\end{example}
\begin{solution}
    令 $y=f(u)$, 则由题设知 $$xf(u)\leqslant \dfrac{1}{2}\qty[xf(x)+uf(u)]\Rightarrow x[f(u)-f(x)]\leqslant f(u)(u-x)$$
    于是 $\forall x\in(0,+\infty)$, 可得
    \begin{flalign*}
        \lim_{u\to x^+}\dfrac{f(u)-f(x)}{u-x}\leqslant \lim_{u\to x^+}\dfrac{f(u)}{x}\Rightarrow f_+'(x)\leqslant \dfrac{f(x)}{x} \\
        \lim_{u\to x^-}\dfrac{f(u)-f(x)}{u-x}\geqslant \lim_{u\to x^-}\dfrac{f(u)}{x}\Rightarrow f_-'(x)\geqslant \dfrac{f(x)}{x}
    \end{flalign*}
    又因为 $f_-'(x)-f_+'(x)$, 则必有 $f'(x)=\dfrac{f(x)}{x}$, 分离变量积分可得该方程的通解为 $f(x)=Cx$, 又因为函数在 $(0,+\infty)$ 上严格单调递增, 则 $C>0$, 即 $f(x)=Cx$, 其中 $C$ 为正常数.
\end{solution}

\subsection{齐次微分方程}

\begin{definition}[齐次微分方程]
    形如 $\dfrac{\dd y}{\dd x}=F\left(\dfrac{y}{x}\right)$ 的方程称为\textit{齐次微分方程}.
\end{definition}

\begin{example}
    \label{yyxxy}求微分方程 $y'=\dfrac{y}{x}+\dfrac{x}{y}$ 的通解.
\end{example}
\begin{solution}
    令 $u=\dfrac{y}{x}$, 则 $y=ux,~\displaystyle\dv{y}{x}=u+x\dv{u}{x}$, 代入原方程, 化为 $\displaystyle x\dv{u}{x}=\dfrac{1}{u}$,
    再化为 $u\dd u=\displaystyle\dv{x}{x}$, 两边积分 $\displaystyle\int u\dd u=\int\dv{x}{x}$, 解得 $\dfrac{u^2}{2}=\ln\qty|Cx|$, 故原方程的通解为
    $\dfrac{1}{2}\dfrac{y^2}{x^2}=\ln|Cx|$, 其中 $C$ 是任意常数.
\end{solution}

\begin{example}
    求微分方程 $\displaystyle\frac{\dd y}{\dd x}-\frac{y}{x}=\frac{1}{\ln\left(x^2+y^2\right)-2\ln x}$ 的通解.
\end{example}
\begin{solution}
    $\displaystyle\text{原式}\Rightarrow\frac{\dd y}{\dd x}-\frac{y}{x}=\ln^{-1}\left[1+\left(\frac{y}{x}\right)^2\right]\xLongrightarrow[]{\frac{y}{x}=z}\ln\left(1+z^2\right)\dd z=\frac{\dd x}{x}$,
    两边积分, 得 $$\displaystyle z\ln\left(1+z^2\right)-2z+2\arctan z=\ln|x|+C$$
    即 $\dfrac{y}{x}\ln\left(1+\dfrac{y^2}{x^2}\right)-\dfrac{2y}{x}+2\arctan\dfrac{y}{x}=\ln|x|+C.$
\end{solution}

\begin{example}[1996 数学 (三)]
    求微分方程 $\displaystyle\frac{\dd y}{\dd x}=\frac{y-\sqrt{x^2+y^2}}{x}$ 的通解.
\end{example}
\begin{solution}
    $\displaystyle\text{原式}\Rightarrow\frac{\dd y}{\dd x}=\frac{y}{x}-\sqrt{1+\left(\frac{y}{x}\right)^2}\xLongrightarrow[]{\frac{y}{x}=z}\frac{\dd z}{-\sqrt{1+z^2}}=\frac{\dd x}{x}$,
    两边积分, 得 $$\displaystyle-\ln\left |\sqrt{1+z^2}+z\right |=\ln|x|+\ln C$$
    即 $\displaystyle\frac{1}{\sqrt{1+z^2}+z}=Cx\Rightarrow\sqrt{x^2+y^2}+y=C.$
\end{solution}

\subsubsection{可化为齐次方程的微分方程}

$$\dfrac{\dd y}{\dd x}=f\left(\dfrac{a_{1} x+b_{1} y+c_{1}}{a_{2} x+b_{2} y+c_{2}}\right)$$

其中 $ a_{1}, b_{1}, c_{1}, a_{2}, b_{2}, c_{2} $ 为常数, 且 $ c_{1}^{2}+c_{2}^{2} \neq 0 $. 当 $ \mqty|a_{1} & b_{1} \\ a_{2} & b_{2}|\neq 0 $ 时,
令 $ x=X+h, y=Y+k $, 由
$\begin{cases}
        a_{1} h+b_{1} k+c_{1}=0 \\
        a_{2} h+b_{2} k+c_{2}=0
    \end{cases}$ 解出 $ h $ 与 $ k $, 可将原方程化为齐次方程
$$\dfrac{\dd Y}{\dd X}=f\left(\dfrac{a_{1} X+b_{1} Y}{a_{2} X+b_{2} Y}\right)=f\left(\dfrac{a_{1}+b_{1} \dfrac{Y}{X}}{a_{2}+b_{2} \dfrac{Y}{X}}\right)=g\left(\dfrac{Y}{X}\right)$$
当 $ \mqty|a_{1} & b_{1} \\ a_{2} & b_{2}|=0 $ 时, 即 $ \dfrac{a_{1}}{a_{2}}=\dfrac{b_{1}}{b_{2}}=k $, 可设 $ u=a_{2} x+b_{2} y $, 代人原方程后可化为可分离变量的微分方程, 即有
$$\dfrac{\dd y}{\dd x}=f\left(\dfrac{k u+c_{1}}{u+c_{2}}\right)=g(u), \quad \dfrac{\dd u}{\dd x}=a_{2}+b_{2} g(u).$$

\subsection{线性微分方程}

\begin{definition}[一阶线性微分方程]
    形如 $\dfrac{\dd y}{\dd x}+p(x)y=q(x)$ 的方程称为\textit{一阶线性微分方程}.
\end{definition}
\begin{theorem}[通解公式]
    对于一阶线性微分方程, 则有通解公式为\index{通解公式}
    $$y=\mathrm{e}^{-\int p(x)\dd x}\left[\int q(x)\cdot\mathrm{e}^{\int p(x)\dd x}\dd x+C\right].$$
\end{theorem}

\begin{example}
    设 $P(x)$ 在 $(-\infty,+\infty)$ 内连续, 且以 $T$ 为周期, 则 $\displaystyle\int_{0}^{T} p(x) \dd x=0$ 是方程 $\displaystyle \dv{y}{x}+p(x)y=0$ 有解 $y=y(x)\not \equiv 0$ 且以 $T$ 为周期的
    \begin{tasks}(4)
        \task 必要不充分条件
        \task 充分不必要条件
        \task 充要条件
        \task 不充分也不必要条件
    \end{tasks}
\end{example}
\begin{solution}
    不定积分可以写成一个变限积分加一个常数 $C$,
    $$
        y=C\e ^{-\int_{0}^{x} p(t) \dd t+C_1}=C\e ^{C_1}\e ^{-\int_{0}^{x} p(t) \dd t}\Rightarrow y=C\e ^{-\int_{0}^{x} p(t)\dd t}
    $$
    那么
    \begin{flalign*}
        y(x+T)-y(x) & =C\e ^{-\int_{0}^{x+T} p(t) \dd t}-C\e ^{-\int_{0}^{x} p(t) \dd t}=C\e ^{-\int_{0}^{x} p(t) \dd t}\qty[\e ^{-\int_{x}^{x+T} p(t) \dd t}-1] \\
                    & \xlongequal{p(x)\text{ 周期为 }T}C\e ^{-\int_{0}^{x} p(t) \dd t}\qty[\e ^{-\int_{0}^{T} p(t) \dd t}-1]
    \end{flalign*}
    充分性: 若 $\displaystyle \int_{0}^{T} p(x) \dd x=0$, 那么 $y(x+T)=y(x)$, 故 $y=y(x)\not \equiv 0$ 且以 $T$ 为周期;\\
    必要性: $y=y(x)\not \equiv 0$ 且以 $T$ 为周期, 故 $y(x+T)-y(x)=0\Rightarrow \displaystyle \e ^{-\int_{0}^{T} p(t) \dd t}-1=0\Rightarrow \int_{0}^{T} p(x) \dd x=0$,
    综上, 选 C.
\end{solution}

\begin{example}
    用一阶线性微分方程的通解公式, 求解例题 \ref{yyxxy}.
\end{example}
\begin{solution}
    原方程化为 $yy'-\dfrac{1}{x}y^2=x$, 即 $\displaystyle\dv{x}\qty(\dfrac{1}{2}y^2)-\dfrac{2}{x}\qty(\dfrac{1}{2}y^2)=x$, 令 $z=\dfrac{1}{2}y^2$, 上式化为
    $\displaystyle\dv{z}{x}-\dfrac{2}{x}z=x$, 由公式得通解为
    $$z=\mathrm{e}^{2\int\frac{\dd x}{x}}\qty[\int x\mathrm{e}^{-2\int\frac{\dd x}{x}}\dd x+C]=x^2\qty(\ln|x|+C)$$
    故原方程的通解为 $\dfrac{1}{2}y^2=x^2\qty(\ln|x|+C).$
\end{solution}

\begin{example}[2009 数二]
    设非负函数 $y=y(x)~(x\geqslant 0)$ 满足微分方程 $xy''-y'+2=0$, 当曲线 $y=y(x)$ 过原点时, 其与直线 $x=1$ 及 $y=0$ 围成平面区域 $D$ 的面积为 $2$, 求 $D$ 绕 $y$ 轴旋转所得旋转体的体积.
\end{example}
\begin{solution}
    \textbf{法一: }令 $y'=p(x)$, 则 $y''=p'(x)$, 代入原方程, 得 $p'(x)-\dfrac{1}{x}p(x)=-\dfrac{2}{x}~(x>0)$, 由通解公式, 得通解为
    $$y'=p(x)=\e ^{\int\frac{\dd x}{x}}\qty[\int\qty(-\dfrac{2}{x})\cdot\e ^{-\int\dfrac{\dd }{x}}+C_1]=2+C_1x$$
    两边积分, 解得 $y=2x+\dfrac{1}{2}C_1x^2+C_2,~(x>0)$, 而由已知 $ y(0)=0 $, 有 $\displaystyle  \lim _{x \to 0^{+}} y(x)=0 $, 于是得 $ C_{2}=0 $, 从而 $\displaystyle  y=2 x+\frac{1}{2} C_{1} x^{2} $, 又由定积分的几何意义, 有 $\displaystyle  2=\int_{0}^{1}\left(2 x+\frac{1}{2} C_{1} x^{2}\right) \mathrm{d} x=1+\frac{1}{6} C_{1} $, 解得 $ C_{1}=6 $, 从而得 $ y=2 x+3 x^{2} $, 由求根公式, 解得 $\displaystyle  x=\frac{1}{3}( \pm \sqrt{3 y+1}-1) $, 因为 $ 0 \leqslant x<1 $, 且 $ y=y(x) $ 非负, 所以 $\displaystyle  x=\frac{1}{3}(-\sqrt{3 y+1}-1) $ 舍去, 从而得 $\displaystyle  x=\frac{1}{3}(\sqrt{3 y+1}-1), 0<y<5 $, 故所求体积为 $$ V=5 \pi-\pi \int_{0}^{5} x^{2} \mathrm{~d} y=5 \pi-\frac{\pi}{9} \int_{0}^{5}(\sqrt{3 y+1}-1)^{2} \mathrm{~d} y=\frac{17 \pi}{6} .$$
    \textbf{法二: }方程两边同时除以 $ x^{2} $, 化为 $\displaystyle  \frac{x y^{\prime \prime}-y^{\prime}}{x^{2}}=-\frac{2}{x^{2}} $, 即 $\displaystyle  \left(\frac{y^{\prime}}{x}\right)^{\prime}=\left(\frac{2}{x}\right)^{\prime} $, 于是得 $\displaystyle  \frac{y^{\prime}}{x}=\frac{2}{x}+C_{1} $, 即 $ y^{\prime}=2+C_{1} x $, 两边积分, 得 $\displaystyle  y=2 x+\frac{C_{1}}{2} x^{2}+C_{2} $, 而由 $ y(0)=0 $, 得 $ C_{2}=0 $, 从而 $\displaystyle  y=2 x+\frac{C_{1}}{2} x^{2} $, 又由定积分的几何意义, 有 $\displaystyle  2=\int_{0}^{1}\left(2 x+\frac{1}{2} C_{1} x^{2}\right) \mathrm{d} x=1+\frac{1}{6} C_{1} $, 解得 $ C_{1}=6 $, 于是 $ y=2 x+3 x^{2} $, 故所求旋转体的体积为
    $$
        V=2 \pi \int_{0}^{1} x y(x) \mathrm{d} x=2 \pi \int_{0}^{1} x\left(2 x+3 x^{2}\right) \mathrm{d} x=\frac{17 \pi}{6} .
    $$
    \textbf{法三: }将方程 $ x y^{\prime \prime}-y^{\prime}+2=0 $, 化简为 $ x y^{\prime \prime}+y^{\prime}-2 y^{\prime}+2=0 $, 即 $ \left(x y^{\prime}-\right.   2 y+2 x)^{\prime}=0 $. 于是得 $ x y^{\prime}-2 y+2 x=C_{1} $, 即 $\displaystyle  y^{\prime}-\frac{2}{x} y=-2+\frac{C_{1}}{x} $, 由通解公式, 其通解为
    $$y=\mathrm{e}^{\int \frac{2}{x} \dd  x}\left[\int\left(-2+\frac{C_{1}}{x}\right) \cdot \mathrm{e}^{-\int \frac{2}{x} \dd  x} \mathrm{d} x+C_{2}\right]=x^{2}\left(\frac{2}{x}-\frac{C_{1}}{2 x^{2}}+C_{2}\right)=2 x-\frac{C_{1}}{2}+C_{2} x^{2} $$
    而由已知 $ y(0)=0 $, 代人得 $ C_{1}=0 $, 于是 $ y=2 x+C_{2} x^{2} $, 又由定积分的几何意义, 有 $\displaystyle  2=\int_{0}^{1}\left(2 x+C_{2} x^{2}\right) \mathrm{d} x=1+\frac{C_{2}}{3} $, 解得 $ C_{2}=3 $, 从而得 $ y=2 x+3 x^{2} $, 故所求旋转体的体积为
    $$V=2 \pi \int_{0}^{1} x y(x) \mathrm{d} x=2 \pi \int_{0}^{1}\left(2 x^{2}+3 x^{3}\right) \mathrm{d} x=\frac{17 \pi}{6} .$$
\end{solution}

\subsection{Bernoulli 微分方程}

\begin{definition}[Bernoulli 微分方程]
    形如 $\dfrac{\dd y}{\dd x}+p(x)y=q(x)y^n,~n\not=0,1$ 的方程称为 \textit{Bernoulli 微分方程}.
\end{definition}

\begin{example}
    将例题 \ref{yyxxy} 化为 Bernoulli 方程, 并求其通解.
\end{example}
\begin{solution}
    原方程化为 $y'-\dfrac{1}{x}y=xy^{-1}$, 此为 Bernoulli 方程, 其中 $n=-1$, 令 $z=y^{1-n}=y^2$, 代入上述方程, 化简得
    $\dfrac{1}{2}\displaystyle\dv{z}{x}-\dfrac{1}{x}z=x$, 即 $\displaystyle\dv{z}{x}-\dfrac{2}{x}z=2x$, 由公式得通解为
    $$z=\mathrm{e}^{2\int\frac{\dd x}{x}}\qty[\int 2x\mathrm{e}^{-2\int\frac{\dd x}{x}}\dd x+C]=x^2\qty(2\ln|x|+C)$$
    故原方程的通解为 $y^2=x^2\qty(2\ln|x|+C).$
\end{solution}

\begin{example}[2023 合肥工业大学]
    设 $f(x)$ 是连续函数, 且满足 $f(x)=\mathrm{e}^x+\mathrm{e}^x\displaystyle\int_{0}^{x}f^2(t)\dd t$, 求 $f(x)$.
\end{example}
\begin{solution}
    由题意可得 $f(0)=1$, 对方程两边 $x$ 同时求导得
    $$f'(x)=\mathrm{e}^x+\mathrm{e}^x\int_{0}^{x}f^2(t)\dd t+\mathrm{e}^xf^2(x)=f(x)+\mathrm{e}^xf^2(x)$$
    该方程为 Bernoulli 方程, 令 $z(x)=\dfrac{1}{f(x)}$, 那么有 $z'(x)+z(x)=-\mathrm{e}^x$, 由通解公式得
    $$z(x)=\mathrm{e}^{-\int\dd x}\qty[\int-\mathrm{e}^x\cdot\mathrm{e}^{\int\dd x}\dd x+C]=-\dfrac{1}{2}\mathrm{e}^x+C\mathrm{e}^{-x}$$
    且 $z(0)=1$, 解得 $C=\dfrac{3}{2}$, 故 $f(x)=\dfrac{2}{3\mathrm{e}^{-x}-\mathrm{e}^x}.$
\end{solution}

\begin{example}
    求微分方程 $y'\cos y=(1+\cos x\sin y)\sin y$ 的通解.
\end{example}
\begin{solution}
    令 $\sin y=z$, 那么原方程可化为 $\displaystyle \dv{z}{x}=z(z\cos x+1)$ 即 $\displaystyle\dv{z}{x}-z=z^2\cos x$, 再令 $z^{-1}=u$, 整理上式得 $\displaystyle\dv{u}{x}+u=-\cos x$, 由通解公式:
    $$u=\e^{-\int\dd x}\qty[-\int\e^{\int\dd x}\dd x+C_1]=-\dfrac{1}{2}(\cos x+\sin x)+C_1\e^{-x}$$
    回代 $u=\dfrac{1}{\sin y}$, 得原方程的通解为 $\dfrac{2}{\sin y}+\cos x+\sin x=C\e^{-x}.$
\end{solution}

\begin{example}[第十四届大学生数学竞赛]
    求方程的通解 $\dfrac{\dd y}{\dd x}x\ln x\sin y+\cos y(1-x\cos y)\dd x=0.$
\end{example}
\begin{solution}
    令 $\cos y=u$, 那么 $u'=-\sin y\cdot y'$, 原式化为 $u'-\dfrac{1}{x\ln x}u=-\dfrac{u^2}{\ln x}$, 则
    \begin{flalign*}
        \text{原式} & \xLongrightarrow[n=2]{z=u^{1-n}}\frac{\dd z}{\dd x}+\frac{1}{x\ln x}z=\frac{1}{\ln x}\Rightarrow z=\mathrm{e}^{-\int\frac{\dd x}{x\ln x}}\left[\int\frac{1}{\ln x}\cdot \mathrm{e}^{\int\frac{\dd x}{x\ln x}}\dd x+C\right] \\
                    & z=\frac{x+C}{\ln x}\Rightarrow \cos y=\frac{\ln x}{x+C}.
    \end{flalign*}
\end{solution}

\subsection{恰当方程与积分因子}

\subsubsection{恰当方程}

\begin{definition}[全微分方程]
    对于微分方程 $$P(x,y)\dd x+Q(x,y)\dd y=0$$
    若 $\displaystyle\pdv{P}{y}=\pdv{Q}{x}$, 则该方程称为\textit{恰当方程}或\textit{全微分方程}.
\end{definition}

\begin{example}
    求微分方程 $\qty(\sin y-y\mathrm{e}^{-x})\dd x+\qty(x\cos y+\mathrm{e}^{-x})\dd y=2x\dd x$ 的通解
\end{example}
\begin{solution}
    记 $P(x,y)=\sin y-y\mathrm{e}^{-x},~Q(x,y)=x\cos y+\mathrm{e}^{-x}$, 则由
    $$\pdv{P}{y}=\cos y-\mathrm{e}^{-x}=\pdv{Q}{x}$$ 知原方程为全微分方程, 且曲线积分 $\displaystyle\int_{(x_0,y_0)}^{(x,y)}P\dd x+Q\dd y$ 与路径无关,
    取 $(x_0,y_0)=(0,0)$, 原函数为
    \begin{flalign*}
        u(x,y) & =\int_{(0,0)}^{(x,y)}P(x,y)\dd x+Q(x,y)\dd y=\int_{0}^{x}P(x,0)\dd x+\int_{0}^{y}Q(x,y)\dd y         \\
               & =\int_{0}^{x}(-2x)\dd x+\int_{0}^{y}\qty(x\cos y+\mathrm{e}^{-x})\dd y=-x^2+x\sin y+y\mathrm{e}^{-x}
    \end{flalign*}
    故原方程的通解为 $u(x,y)\equiv C$, 即 $x\sin y+y\mathrm{e}^{-x}-x^2\equiv C.$
\end{solution}

\begin{example}
    求微分方程 $y''\qty(3y'^2-x)=y'$ 的通解.
\end{example}
\begin{solution}
    原方程化为 $y''\qty(3y'^2-x)-y'=0$, 且注意到 $\dd \qty(y'^3)=3y'^2,~\dd \qty(xy')=y'+xy''$, 于是原式化为
    $$\dd \qty(y'^3-xy')=0\Rightarrow y'^3-xy'=C_1$$
    令 $p=y'=\displaystyle\dv{y}{x}$, 那么 $\dd x=\dfrac{\dd y}{p}$, 则 $p^3-xp=C_1$, 即 $x=p^2-\dfrac{C_1}{p}$,
    两边全微分得 $$\dd x=2p\dd p+\dfrac{C_1\dd p}{p^2}$$
    代入 $\dd x=\dfrac{\dd y}{p}$, 得 $\dd y=\qty(2p^2+\dfrac{C_1}{p})\dd p$, 为变量分离方程, 于是两边积分得
    $$\int\dd y=\int\qty(2p^2+\dfrac{C_1}{p})\dd p\Rightarrow y=\dfrac{2}{3}p^3+C_1\ln p+C_2$$
    其中 $x=p^2-\dfrac{C_1}{p}.$
\end{solution}

% \begin{definition}
%     将一阶方程 $\displaystyle\frac{\dd y}{\dd x}=f(x,y)$ 写成微分形式 $f(x,y)\dd x-\dd y=0$
%     或把 $x,y$ 平等看待, 写成下面具有对称形式的一阶微分方程:
%     $$P(x,y)\dd x+Q(x,y)\dd y=0$$
%     如果上述方程的右端恰好是某个二元函数 $u(x,y)$ 的全微分, 即
%     $$u_x'=P(x,y),~u_y'=Q(x,y)$$
%     则称它为恰当微分方程.
% \end{definition}
% \begin{definition}
%     如果可微函数 $\mu(x,y)$ 使得方程 $$\mu(x,y)P(x,y)\dd x+\mu(x,y)Q(x,y)\dd y=0$$
%     是恰当的, 则称 $\mu(x,y)$ 是方程的积分因子.
% \end{definition}

以下一些简单函数的全微分公式, 将对我们较快地进行这种重新组合有所帮助.
\setcounter{magicrownumbers}{0}
\begin{table}[H]
    \centering
    \caption{简单函数的全微分公式}
    \begin{tabular}{l l}
        (\rownumber{}) $x\dd y+y\dd x=\dd (xy)$                                                   & (\rownumber{}) $x\dd x+y\dd y=\dfrac{1}{2}\dd \qty(x^2+y^2)$                 \\
        \midrule
        (\rownumber{}) $\dfrac{x\dd y-y\dd x}{x^2}=\dd \qty(\dfrac{y}{x})$                        & (\rownumber{}) $\dfrac{x\dd y-y\dd x}{y^2}=\dd \qty(-\dfrac{x}{y})$          \\
        (\rownumber{}) $\dfrac{2xy\dd y-y^2\dd x}{x^2}=\dd\qty(\dfrac{y^2}{x})$                   & (\rownumber{}) $\dfrac{2xy\dd x-x^2\dd y}{y^2}=\dd \qty(\dfrac{x^2}{y})$     \\
        \midrule
        (\rownumber{}) $\dfrac{x\dd x+y\dd y}{x^2+y^2}=\dfrac{1}{2}\dd \qty[\ln\qty(x^2+y^2)]$    & (\rownumber{}) $\dfrac{x\dd y-y\dd x}{x^2+y^2}=\dd\qty(\arctan\dfrac{y}{x})$ \\
        (\rownumber{}) $\dfrac{x\dd y-y\dd x}{x^2-y^2}=\dfrac{1}{2}\dd \qty(\ln\dfrac{x+y}{x-y})$ & (\rownumber{}) $\dfrac{x\dd y-y\dd x}{xy}=\dd \qty(\ln\dfrac{y}{x})$         \\
    \end{tabular}
\end{table}

\subsubsection{积分因子}

\begin{theorem}[积分因子]
    \index{积分因子}
    若微分方程 $P(x,y)\dd x+Q(x,y)\dd y=0$ 不满足 $\displaystyle\frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}$,
    令 $\Delta _\partial=\displaystyle\pdv{P}{y}-\pdv{Q}{x}$, 那么对于以下特殊情况, 可确定积分因子.
    \begin{enumerate}[label=(\arabic{*})]
        \item 若 $\displaystyle\frac{\Delta _\partial}{Q}$ 与 $y$ 无关, 则有积分因子 $\displaystyle\mu(x)=\exp\int\dfrac{\Delta_\partial}{Q}\dd x.$
        \item 若 $\displaystyle\frac{\Delta _\partial}{P}$ 与 $x$ 无关, 则有积分因子 $\displaystyle\mu(y)=\exp\int\dfrac{-\Delta_\partial}{P}\dd y.$
        \item 若满足 $f\qty(mx^a+ny^b)=\dfrac{\Delta _\partial}{max^{a-1}Q-nby^{b-1}P}$, 则有积分因子 $$\mu(xy)=\exp\int f\qty(mx^a+ny^b)\dd \qty(mx^a+ny^b).$$
        \item 若满足 $f\qty(\sqrt{x^ay^b})=\dfrac{2\sqrt{x^ay^b}\Delta_\partial}{x^{a-1}y^{b-1}(ayQ-bxP)}$, 则有积分因子
              $$\mu(xy)=\exp\int f\qty(\sqrt{x^ay^b})\dd \qty(\sqrt{x^ay^b}).$$
    \end{enumerate}
\end{theorem}

\begin{example}
    求解下列方程的通解.
    \setcounter{magicrownumbers}{0}
    \begin{table}[H]
        \centering
        \begin{tabular}{l | l}
            (\rownumber{}) $\qty(x+y^2)\dd x-2xy\dd y=0.$ & (\rownumber{}) $(x-y)\dd x+(x+y)\dd y=0.$              \\
            (\rownumber{}) $(1+xy)y\dd x+(1-xy)x\dd y=0.$ & (\rownumber{}) $x\dd x=\qty(\dfrac{x^2}{y}-y^3)\dd y.$ \\
        \end{tabular}
    \end{table}
\end{example}
\begin{solution}
    \begin{enumerate}[label=(\arabic{*})]
        \item $P(x,y)=x+y^2,~Q=-2xy$, 于是 $\dfrac{1}{Q}\qty(\displaystyle\pdv{P}{y}-\pdv{Q}{x})=-\dfrac{2}{x}$,
              于是有积分因子 $$\mu(x)=\exp\qty(-2\displaystyle\int\dfrac{\dd x}{x})=\dfrac{1}{x^2}$$
              方程两边同时乘以积分因子 $\mu(x)$, 并化简为 $\dd \qty(\ln|x|)+\dd \qty(-\dfrac{y^2}{x})=0$, 故原方程的通解为 $$\ln|x|-\dfrac{y^2}{x}\equiv C.$$
        \item $\displaystyle\pdv{P}{y}-\pdv{Q}{x}=-2$, 于是 $\dfrac{-2}{2(xQ-yP)}=-\dfrac{1}{x^2+y^2}$, 则有积分因子 $$\mu(xy)=\exp\qty(-\displaystyle\int\dfrac{\dd \qty(x^2+y^2)}{x^2+y^2})=\dfrac{1}{x^2+y^2}$$
              方程两边同时乘以积分因子 $\mu(xy)$, 得 $\dfrac{x-y}{x^2+y^2}\dd x+\dfrac{x+y}{x^2+y^2}\dd y=0$,
              整理得 $$\dfrac{x\dd y-y\dd x}{x^2+y^2}+\dfrac{x\dd x+y\dd y}{x^2+y^2}=0\Rightarrow \dd \qty(\arctan\qty(\dfrac{y}{x}))+\dd \qty(\dfrac{\ln\qty(x^2+y^2)}{2})=0$$
              故原方程的通解为 $\arctan\dfrac{y}{x}+\dfrac{1}{2}\ln\qty(x^2+y^2)\equiv C.$
        \item $\Delta_\partial=4xy$, 于是 $\dfrac{2x^2y^2\cdot\Delta_\partial}{x^3y^3[4(-2xy)]}=-\dfrac{1}{xy}$, 则有积分因子 $\mu(xy)=\exp\qty(-\displaystyle\int\dfrac{\dd xy}{xy})=\dfrac{1}{xy}$,
              方程两边同时乘以积分因子 $\mu(xy)$, 得 $\dfrac{1+xy}{x}\dd x+\dfrac{1-xy}{y}\dd y=0$, 整理得
              \begin{flalign*}
                  \dfrac{1+xy}{x}\dd x+\dfrac{1-xy}{y}\dd y & =\dfrac{\dd x}{x}+y\dd x+\dfrac{\dd y}{y}-x\dd y=\qty(\dfrac{\dd x}{x}+\dfrac{\dd y}{y})+\qty(y\dd x-x\dd y)                                                     \\
                                                            & =\dfrac{1}{xy}\qty(y\dd x-x\dd y)+\dfrac{1}{xy}\qty(\dfrac{\dd x}{x}+\dfrac{\dd y}{y})=\dfrac{y}{x}\cdot\dfrac{y\dd x-x\dd y}{y^2}+\dfrac{y\dd x+x\dd y}{x^2y^2} \\
                                                            & =\dd \qty(\ln\dfrac{x}{y})+\dd \qty(-\dfrac{1}{xy})=\dd \qty(\ln\dfrac{x}{y}-\dfrac{1}{xy})=0
              \end{flalign*}
              故原方程的通解为 $\ln\dfrac{x}{y}-\dfrac{1}{xy}\equiv C.$
        \item 方程化为 $x\dd x+\qty(y^3-\dfrac{x^2}{y})\dd y=0$, 那么 $\Delta_\partial=\dfrac{2x}{y}$, 那么有积分因子 $\mu(y)=\exp\displaystyle\int\dfrac{-\Delta_\partial}{P}\dd y=\dfrac{1}{y^2}$,
              方程两边同时乘以积分因子 $\mu(y)$, 得 $\dfrac{x}{y^2}\dd x+\qty(y-\dfrac{x^2}{y^3})\dd y=0$, 整理得
              \begin{flalign*}
                  \dfrac{x}{y^2}\dd x+\qty(y-\dfrac{x^2}{y^3})\dd y=\dfrac{2x}{y^2}\dd x+2\qty(y-\dfrac{x^2}{y^3})\dd y=2y\dd y+\dfrac{2xy\dd x}{y^3}-\dfrac{2x^2\dd y}{y^3}=\dd \qty(y^2)+\dd \qty(\dfrac{x^2}{y^2})=0
              \end{flalign*}
              故原方程的通解为 $y^2+\dfrac{x^2}{y^2}\equiv C.$
    \end{enumerate}
\end{solution}

\begin{theorem}
    若 $\mu=\mu(x,y)$ 是微分方程 $P(x,y)\dd x+Q(x,y)\dd y=0$ 的一个积分因子, 使得
    $$\mu(x,y)P(x,y)\dd x+\mu(x,y)Q(x,y)\dd y=\dd \Phi(x,y)$$
    则 $\mu(x,y)g(\Phi(x,y))$ 也是该方程的一个积分因子, 其中 $g$ 是任意一可微的非零函数.
\end{theorem}
\begin{theorem}[积分因子的存在性定理]
    如果微分方程 $P(x,y)\dd x+Q(x,y)\dd y=0$ 有通解 $u(x,y)=C$, 那么它总有一个积分因子 $\mu=\mu(x,y)$, 同时 $\mu\varphi(u)$ 也是该方程的一个积分因子, 并且方程的积分因子必须具有 $\mu\varphi(u)$ 的形式, 其中 $\varphi(u)$ 是 $u$ 的任意一个可微函数.
    \index{积分因子的存在性定理}
\end{theorem}

\begin{example}
    求解下列方程.
    \setcounter{magicrownumbers}{0}
    \begin{table}[H]
        \centering
        \begin{tabular}{l | l}
            (\rownumber{}) $x(4y\dd x+2x\dd y)+y^3(3y\dd x+5x\dd y)=0.$ & (\rownumber{}) $\qty(x^3y-2y^2)\dd x+x^4\dd y=0.$ \\
        \end{tabular}
    \end{table}
\end{example}
\begin{solution}
    \begin{enumerate}[label=(\arabic{*})]
        \item 对第一组, 有
              $$x(4y\dd x+2x\dd y)=x\qty[(2y\dd x+2x\dd y)+2y\dd x]=x\qty[2\dd (xy)+2y\dd x]=2x\dd (xy)+2xy\dd x=\dd \qty(2x^2y)$$
              则其积分因子和二元函数为 $$\mu_1=1,~u_1=2x^2y$$
              对第二组, 有 $$y^3(3y\dd x+5x\dd y)=3y^4\dd x+5xy^3\dd y$$
              易见它有一个积分因子 $\mu_2=\dfrac{1}{xy^4}$, 相乘后得 $$\dfrac{3}{x}\dd x+\dfrac{5}{y}\dd y=3\dd \qty(\ln|x|)+5\dd \qty(\ln|y|)=\dd \qty(\ln\qty|x^3y^5|)$$
              相应地有 $u_2=\ln\qty|x^3y^5|$, 根据积分因子的存在性定理, 可以考虑选择适当的可微函数 $\varphi$ 与 $\tilde{\varphi } $ 使得
              $$1\cdot\varphi\qty(2x^2y)=\dfrac{1}{xy^4}\tilde{\varphi } \qty(\ln\qty|x^3y^5|)$$
              取 $\varphi\qty(2x^2y)=2x^2y,~\tilde{\varphi } \qty(\ln\qty|x^3y^5|)=2x^3y^5$, 则得到原方程的一个积分因子 $\mu=2x^2y$, 将它乘原方程两边, 得
              $$2x^2y\dd \qty(2x^2y)+6x^2y^5\dd x+10x^3y^4\dd y=0$$
              即 $$\dfrac{1}{2}\dd \qty(2x^2y)^2+2y^5\dd x^3+2x^3\dd y^5=\dd \qty(2x^4y^2)+\dd \qty(2x^2y^5)=\dd \qty(2x^4y^2+2x^3y^5)=0$$
              故原方程的通解为 $x^4y^2+x^3y^5=C.$
        \item 将方程改写为 $$x^3y\dd x+x^4\dd y+\qty(-2y^2)\dd x=0$$
              即 $$x^3\qty(y\dd x+x\dd y)+\qty(-2y^2)\dd x=0\Rightarrow x^3\dd (xy)+\qty(-2y^2)\dd x=0$$
              第一组有积分因子 $\mu_1=\dfrac{1}{x^3}$ 和原函数 $u_1=xy$; 第二组有积分因子 $\mu_2=\dfrac{1}{-2y^2}$ 和原函数 $u_2=x$, 现寻找可微函数 $\varphi$ 与 $\tilde{\varphi } $, 使得
              $$\dfrac{1}{x^3}\varphi(xy)=\dfrac{1}{-2y^2}\tilde{\varphi } $$
              取 $\varphi(xy)=\dfrac{1}{(xy)^2},~\tilde{\varphi } =-\dfrac{2}{x^5}$, 则得到原方程的一个积分因子 $\mu=\mu(x,y)=\dfrac{1}{x^5y^2}$, 将它乘原方程两边, 得
              $$\dfrac{\dd (xy)}{x^2y^2}-\dfrac{2}{x^5}\dd x=0$$
              即 $$\dd \qty(-\dfrac{1}{xy})+\dd \qty(\dfrac{1}{2x^4})=0$$
              故原方程的通解为 $\dfrac{1}{2x^4}-\dfrac{1}{xy}=C.$
    \end{enumerate}
\end{solution}

\subsection{参数式通解}

形如 $F(y,y')=0$ 或 $F(x,y')=0$ 的方程, 可考虑用 “参数式解法” 求解, 对方程 $F(y,y')=0$, 可令 $y=\varphi(t)$, 由方程解得 $y'=\psi(t)$ (显然 $y=\varphi(t)$ 或 $y'=\psi(t)$ 的选择具有多样性), 再由 $\dd x=\dfrac{\dd y}{y'}=\dfrac{\varphi'(t)}{\psi(t)}\dd t$, 积分得 $\displaystyle x=\int\dfrac{\varphi'(t)}{\psi(t)}\dd t$,
即微分方程的通解为 $\begin{cases}
        \displaystyle x=\int\dfrac{\varphi'(t)}{\psi(t)}\dd t \\
        y=\varphi(t)
    \end{cases}$, 同理可得 $F(x,y')=0$ 型方程的求解.

\begin{example}
    求微分方程 $y+y'=\ln\sqrt{1+y'^2}$ 的通解.
\end{example}
\begin{solution}
    令 $y'=\tan t$, 代入方程得 $y=\ln|\sec t|-\tan t$, 所以
    $$
        \dd x=\dfrac{\dd y}{y'}=\qty(1-\dfrac{\sec^2 t}{\tan t})\dd t\Rightarrow x=t-\ln|\tan t|+C
    $$
    于是得到微分方程参数形式的通解 $\begin{cases}
            x=t-\ln|\tan t|+C \\
            y=\ln|\sec t|-\tan t.
        \end{cases}$
\end{solution}